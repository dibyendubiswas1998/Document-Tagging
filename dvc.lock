schema: '2.0'
stages:
  data_ingestion:
    cmd: python src/document_tagging/pipeline/data_ingestion.py
    deps:
    - path: config/config.yaml
      hash: md5
      md5: 6aee7cabf2472115d17d4be1c09a47e2
      size: 944
    - path: config/secrect.yaml
      hash: md5
      md5: d62a3abb3164d96501289008bbf59803
      size: 788
    - path: src/document_tagging/pipeline/data_ingestion.py
      hash: md5
      md5: 8c4d6961e5c72a117b158b0e41695ece
      size: 2438
    outs:
    - path: artifacts/data/data.csv
      hash: md5
      md5: 9c0ac98dcf46d535309f53fd3b38d279
      size: 2442644
  data_preprocessing:
    cmd: python src/document_tagging/pipeline/data_preprocessing.py
    deps:
    - path: config/config.yaml
      hash: md5
      md5: 6aee7cabf2472115d17d4be1c09a47e2
      size: 944
    - path: src/document_tagging/pipeline/data_preprocessing.py
      hash: md5
      md5: e50ebc023dbed10b56be0f953598da01
      size: 2230
    outs:
    - path: artifacts/data/labels.json
      hash: md5
      md5: 46b9bd2be6a0a32c6397df38c792a560
      size: 25
    - path: artifacts/data/tag2id.json
      hash: md5
      md5: b8fe29aec76a3c08e44c957d0cc39d3e
      size: 182065
    - path: artifacts/data/test.pth
      hash: md5
      md5: 52c999ee4b3f76cf7a26b4d751d7a199
      size: 8150387
    - path: artifacts/data/train.pth
      hash: md5
      md5: 4aa247137e854d0adff5b56469f8d106
      size: 38197478
    - path: artifacts/data/valid.pth
      hash: md5
      md5: 9a396af1946e2b762d5cd8e56644615c
      size: 8168352
  model_training:
    cmd: python src/document_tagging/pipeline/model_training.py
    deps:
    - path: config/config.yaml
      hash: md5
      md5: 6aee7cabf2472115d17d4be1c09a47e2
      size: 944
    - path: src/document_tagging/pipeline/model_training.py
      hash: md5
      md5: 2870b0c9291bafa57f39c8ec08caf323
      size: 1767
    params:
      params.yaml:
        TrainingArguments.eval_steps: 500
        TrainingArguments.evaluation_strategy: epoch
        TrainingArguments.gradient_accumulation_steps: 16
        TrainingArguments.learning_rate: 2e-05
        TrainingArguments.logging_steps: 10
        TrainingArguments.num_train_epochs: 7
        TrainingArguments.per_device_eval_batch_size: 8
        TrainingArguments.per_device_train_batch_size: 8
        TrainingArguments.save_steps: 1000000
        TrainingArguments.save_strategy: no
        TrainingArguments.save_total_limit: 0
        TrainingArguments.warmup_steps: 500
        TrainingArguments.weight_decay: 0.01
    outs:
    - path: artifacts/model/doc_tag_model
      hash: md5
      md5: 3c5a3d21b1311b230bd291352c452548.dir
      size: 462186526
      nfiles: 2
    - path: artifacts/model/log
      hash: md5
      md5: 949786094c0167ee644bcfd54f575ff9.dir
      size: 438048
      nfiles: 1
  model_evaluation:
    cmd: python src/document_tagging/pipeline/model_evaluation.py
    deps:
    - path: config/config.yaml
      hash: md5
      md5: 6aee7cabf2472115d17d4be1c09a47e2
      size: 944
    - path: src/document_tagging/pipeline/model_evaluation.py
      hash: md5
      md5: 484ef4568c90760d16b853955d953928
      size: 2396
    params:
      params.yaml:
        TrainingArguments.eval_steps: 500
        TrainingArguments.evaluation_strategy: epoch
        TrainingArguments.gradient_accumulation_steps: 16
        TrainingArguments.learning_rate: 2e-05
        TrainingArguments.logging_steps: 10
        TrainingArguments.num_train_epochs: 7
        TrainingArguments.per_device_eval_batch_size: 8
        TrainingArguments.per_device_train_batch_size: 8
        TrainingArguments.save_steps: 1000000
        TrainingArguments.save_strategy: no
        TrainingArguments.save_total_limit: 0
        TrainingArguments.warmup_steps: 500
        TrainingArguments.weight_decay: 0.01
    outs:
    - path: artifacts/report/performace_report.json
      hash: md5
      md5: e0d35c12e77564833c455d8a7418b433
      size: 374
